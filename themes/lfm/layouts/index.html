{{ define "main" }}
<div class="hero">
  <div class="hero-terminal">
    <div class="terminal-header">
      <span class="terminal-dot red"></span>
      <span class="terminal-dot yellow"></span>
      <span class="terminal-dot green"></span>
      <span class="terminal-title">manifesto@lfm ~</span>
    </div>
    <div class="terminal-body">
      <div class="terminal-line">
        <span class="terminal-prompt">$</span>
        <span class="terminal-command" id="typewriter"></span>
        <span class="terminal-cursor">_</span>
      </div>
    </div>
  </div>
  <p class="hero-tagline">{{ .Site.Params.tagline }}</p>
</div>

<!-- Latest Podcast Episode -->
{{ $podcasts := where .Site.RegularPages "Section" "podcast" }}
{{ with (first 1 $podcasts) }}
<section class="home-section">
  <div class="section-header">
    <h2 class="section-title">
      <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"/><path d="M19 10v2a7 7 0 0 1-14 0v-2"/><line x1="12" y1="19" x2="12" y2="23"/><line x1="8" y1="23" x2="16" y2="23"/></svg>
      Latest Episode
    </h2>
    <a href="/podcast/" class="section-link">All Episodes &rarr;</a>
  </div>
  {{ range . }}
  <div class="podcast-card">
    <div class="podcast-card-header">
      <div>
        {{ with .Params.episode }}
        <span class="podcast-card-episode">Episode {{ . }}</span>
        {{ end }}
        <h3 class="podcast-card-title">
          <a href="{{ .Permalink }}">{{ .Title }}</a>
        </h3>
        <span class="podcast-card-date">{{ .Date.Format "January 2, 2006" }}</span>
      </div>
    </div>
    <p class="podcast-card-description">{{ .Description }}</p>
    {{ with .Params.audio }}
    <div class="audio-player">
      <audio controls preload="metadata">
        <source src="{{ . }}" type="audio/mpeg">
        Your browser does not support the audio element.
      </audio>
    </div>
    {{ end }}
    {{ with .Params.buzzsprout_id }}
    <div class="audio-player">
      <iframe src="https://www.buzzsprout.com/{{ $.Site.Params.buzzsprout_id }}/{{ . }}?client_source=small_player&iframe=true" loading="lazy" width="100%" height="200" frameborder="0" scrolling="no" title="Light Fighter Manifesto"></iframe>
    </div>
    {{ end }}
  </div>
  {{ end }}
</section>
{{ end }}

<!-- Latest Article -->
{{ $articles := where .Site.RegularPages "Section" "articles" }}
{{ with (first 1 $articles) }}
<section class="home-section">
  <div class="section-header">
    <h2 class="section-title">
      <svg class="section-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><polyline points="10 9 9 9 8 9"/></svg>
      Latest Article
    </h2>
    <a href="/articles/" class="section-link">All Articles &rarr;</a>
  </div>
  <div class="article-list">
    {{ range . }}
    <article class="article-card featured">
      <h3 class="article-card-title">
        <a href="{{ .Permalink }}">{{ .Title }}</a>
      </h3>
      <div class="article-card-meta">
        {{ .Date.Format "January 2, 2006" }}
        {{ with .Params.author }} &middot; {{ . }}{{ end }}
      </div>
      <p class="article-card-excerpt">{{ .Description }}</p>
    </article>
    {{ end }}
  </div>
</section>
{{ end }}

<script>
// Typewriter effect
const text = "./lightfighter --init";
const typewriter = document.getElementById('typewriter');
let i = 0;

function type() {
  if (i < text.length) {
    typewriter.textContent += text.charAt(i);
    i++;
    setTimeout(type, 100);
  }
}

// Start typing after a short delay
setTimeout(type, 500);
</script>

{{ end }}
